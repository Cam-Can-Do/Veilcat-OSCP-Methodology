# Post-Exploitation Enumeration Checklist

**Use this AFTER getting admin/SYSTEM on a machine - even if you already rooted it.**
**DO NOT IMMEDIATELY PIVOT. Enumerate first for lateral movement credentials.**

---

## Windows Post-Exploitation (After Admin/SYSTEM)

### Credential Harvesting (HIGHEST PRIORITY)

- [ ] **Mimikatz logonpasswords:** [[Windows Privilege Escalation#Mimikatz logonpasswords|Mimikatz logonpasswords]]
- [ ] **Read Mimikatz output:** Extract ALL hashes and plaintext passwords, write them down
- [ ] **PowerShell history (ALL users):** [[Windows Privilege Escalation#Find PSReadline history|Find PSReadline history]]
- [ ] **Read each history file:** `type <path>` - Look for passwords, hashes, admin commands
- [ ] **Administrator history specifically:** `type C:\Users\Administrator\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt`

### File/Application Enumeration

- [ ] **Check for unusual files:** [[Windows Privilege Escalation#Search for files|Search for files]]
- [ ] **Download unusual .exe files** and run `strings` locally (may have hardcoded creds)
- [ ] **Check for database files:** [[Windows Privilege Escalation#Search for database files|Search for database files]]
- [ ] **Check common credential locations:** `C:\Users\*\Desktop`, `C:\Users\*\Documents`, `C:\Backup`, `C:\Temp`
- [ ] **Registry saved credentials:** [[Windows Privilege Escalation#Check autologon registry|Check autologon registry]]

### Network/Pivoting Setup

- [ ] **Check network interfaces:** `ipconfig /all` (multiple NICs? Internal network?)
- [ ] **Check listening services:** `netstat -ano` (internal services to target?)
- [ ] **If pivot needed:** Set up ligolo tunnel before continuing enumeration on internal network
- [ ] **Check ARP cache:** `arp -a` (discover internal hosts)

### Domain Context (If Domain-Joined)

- [ ] **Run SharpHound:** [[Active Directory#Run SharpHound|Run SharpHound]] (get fresh BloodHound data from this perspective)
- [ ] **Test all found credentials with NetExec** across domain (see [[CHECKLIST-AD-Domain]])
- [ ] **Check for cached credentials:** Mimikatz may reveal domain accounts

### Re-Enumerate Web Apps (If Web Server Running)

- [ ] **Re-check web directories:** Did you find all databases/config files?
- [ ] **Test database access with admin:** Connect as SYSTEM to local MySQL/MSSQL
- [ ] **Dump database contents:** Extract all credentials from all tables
- [ ] **Check for vhosts:** Review IIS/Apache configs for additional sites

---

## Linux Post-Exploitation (After Root)

### Credential Harvesting

- [ ] **Dump /etc/shadow:** [[Linux Privilege Escalation#Check sensitive files|Check sensitive files]]
- [ ] **Crack shadow hashes:** `unshadow passwd shadow > hashes.txt` → `john hashes.txt --wordlist=rockyou.txt`
- [ ] **Check all bash histories:** [[Linux Privilege Escalation#Check bash history|Check bash history]]
- [ ] **Search for SSH keys:** [[Linux Privilege Escalation#grep for private keys|grep for private keys]]
- [ ] **Check for passwords in files:** [[Linux Privilege Escalation#grep etc for credentials|grep etc for credentials]]

### Application/Database Access

- [ ] **Access databases as root:** [[Linux Privilege Escalation#MySQL shell escape|MySQL shell escape]]
- [ ] **Dump all databases:** Extract credentials from application databases
- [ ] **Check web configs:** [[Linux Privilege Escalation#Check application configs|Check application configs]]
- [ ] **Review /opt and /var/backups:** [[Linux Privilege Escalation#Find backup files|Find backup files]]

### Network/Pivoting Setup

- [ ] **Check network interfaces:** `ip addr` or `ifconfig` (internal network?)
- [ ] **Check listening ports:** `ss -tulnp` or `netstat -tulnp` (internal services?)
- [ ] **If pivot needed:** Set up ligolo or SSH tunnel
- [ ] **Check /etc/hosts:** Additional internal hosts defined?

### Test Found Credentials Elsewhere

- [ ] **Test SSH across network:** Try found passwords on other machines
- [ ] **Test database creds:** Same passwords on other database servers?
- [ ] **Test reused passwords:** Users often reuse passwords across systems

---

## Systematic Credential Testing (After Gathering)

**For EACH credential/hash found, test systematically:**

### If Windows Environment:
```
[ ] netexec smb <all-targets> -u <user> -p '<password>'
[ ] netexec smb <all-targets> -u <user> -H <hash>
[ ] netexec winrm <all-targets> -u <user> -p '<password>'
[ ] netexec mssql <all-targets> -u <user> -p '<password>'
[ ] Test with --local-auth if domain auth fails
```

### If Linux Environment:
```
[ ] SSH to other Linux boxes: ssh <user>@<target>
[ ] Test on databases: mysql -h <target> -u <user> -p
[ ] Test password reuse across all found services
```

---

## Common Mistakes (STOP DOING THESE)

**From your Challenge Labs:**

❌ **"I got SYSTEM, time to pivot"**
- You missed passwords in PowerShell history
- You missed Mimikatz credentials
- You missed database files

❌ **"I checked Mimikatz, done with credentials"**
- Did you check PowerShell history?
- Did you enumerate unusual .exe files?
- Did you re-check web apps with admin access?

❌ **"I found one password, good enough"**
- Keep searching ALL locations
- Check ALL user directories
- Enumerate ALL databases

---

## Time Investment

**Spend 10-15 minutes on thorough post-exploitation BEFORE pivoting.**

This time investment prevents getting stuck later when you realize you missed credentials that would have unlocked other machines.

---

## After Completing This Checklist

- [ ] **Write down all credentials found**
- [ ] **Test each credential systematically** (use [[CHECKLIST-AD-Domain]] for AD environments)
- [ ] **Only then proceed to next target**

## Reference

- Windows commands: [[Windows Privilege Escalation]]
- Linux commands: [[Linux Privilege Escalation]]
- AD testing: [[CHECKLIST-AD-Domain]]
