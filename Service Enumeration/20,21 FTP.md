## nmap FTP vulnerability scripts
```bash
nmap --script ftp-anon,ftp-bounce,ftp-libopie,ftp-proftpd-backdoor,ftp-vsftpd-backdoor,ftp-vuln-cve2010-4221 -p 21 $IP
```

## Recursively download FTP files with wget
```bash
wget -r ftp://anonymous:anonymous@$IP/
```

## Brute force FTP login (Hydra)
```bash
hydra -l admin -P /usr/share/wordlists/rockyou.txt ftp://$IP
```

---

# FTP Enumeration Methodology

## Initial Testing

1. Check for anonymous access 
2. Download everything for offline analysis
3. Look for sensitive files (passwords, configs, backups, keys)

## Anonymous FTP Access

Try these username/password combinations:
- anonymous:anonymous
- anonymous:
- ftp:ftp
- guest:guest

## FTP Commands

Once connected, useful commands:
- `ls` - list files
- `cd directory` - change directory
- `get filename` - download file
- `put filename` - upload file (if writable)
- `mget *` - download multiple files
- `binary` - switch to binary mode (for executables/images)
- `ascii` - switch to ASCII mode (for text files)
- `pwd` - print working directory
- `passive` - toggle passive mode

## Common FTP Misconfigurations

**Writable anonymous FTP:**
If you can write files, you might be able to:
- Upload a web shell if FTP directory is web-accessible
- Upload malicious files for other users to execute
- Replace legitimate files with backdoored versions

**Home directory access:**
Sometimes FTP exposes user home directories, which may contain:
- SSH keys (.ssh/id_rsa)
- Bash history (.bash_history)
- Configuration files with credentials

## Version-Specific Vulnerabilities

**ProFTPd:**
- Check for backdoored versions (CVE-2010-4221)
- SITE CPFR/CPTO commands for arbitrary file copy

**vsftpd:**
- Backdoor in version 2.3.4 (smiley face backdoor)
- nmap script ftp-vsftpd-backdoor detects this

**Pure-FTPd, FileZilla Server:**
- Check for known vulnerabilities based on version

---

# References

- https://book.hacktricks.xyz/network-services-pentesting/pentesting-ftp
- https://www.exploit-db.com/exploits/17491 (vsftpd backdoor)
